<local:DraggableWidget x:Class="StudyDashboard.SessionStatsWidget"
                     xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                     xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                     xmlns:local="clr-namespace:StudyDashboard">
    
    <Border Style="{StaticResource WidgetStyle}">
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>
            
            <!-- ヘッダー -->
            <TextBlock Grid.Row="0" Text="Session Stats" Style="{StaticResource HeaderTextStyle}"/>
            
            <!-- スクロール可能なコンテンツ -->
            <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Disabled"
                          Style="{StaticResource DarkScrollViewer}">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
            
            <!-- 日付タイムライン -->
            <Border Grid.Row="0" Background="#20FFFFFF" CornerRadius="4" Padding="5" Margin="0,0,0,10">
                <StackPanel x:Name="DateTimeline" Orientation="Horizontal" HorizontalAlignment="Center"/>
            </Border>
            
            <!-- 統計カード 2x2 -->
            <Grid Grid.Row="1" Margin="0,0,0,10">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition/>
                    <ColumnDefinition/>
                </Grid.ColumnDefinitions>
                <Grid.RowDefinitions>
                    <RowDefinition/>
                    <RowDefinition/>
                </Grid.RowDefinitions>
                
                <Border Grid.Row="0" Grid.Column="0" Background="#25FFFFFF" CornerRadius="5" Margin="2" Padding="12">
                    <StackPanel>
                        <TextBlock Text="14d Avg" FontSize="10" Foreground="#AAFFFFFF"/>
                        <TextBlock x:Name="AvgMinText" Text="0 min" FontSize="24" FontWeight="Bold" Foreground="White"/>
                        <TextBlock Text="平均集中時間" FontSize="10" Foreground="#88FFFFFF"/>
                    </StackPanel>
                </Border>
                
                <Border Grid.Row="0" Grid.Column="1" Background="#25FFFFFF" CornerRadius="5" Margin="2" Padding="12">
                    <StackPanel>
                        <TextBlock Text="Best Day" FontSize="10" Foreground="#AAFFFFFF"/>
                        <TextBlock x:Name="BestDayText" Text="-- (0 min)" FontSize="20" FontWeight="Bold" Foreground="White"/>
                        <TextBlock x:Name="BestDayDateText" Text="" FontSize="10" Foreground="#88FFFFFF"/>
                    </StackPanel>
                </Border>
                
                <Border Grid.Row="1" Grid.Column="0" Background="#25FFFFFF" CornerRadius="5" Margin="2" Padding="12">
                    <StackPanel>
                        <TextBlock Text="Active Days" FontSize="10" Foreground="#AAFFFFFF"/>
                        <TextBlock x:Name="ActiveDaysText" Text="0 / 14" FontSize="24" FontWeight="Bold" Foreground="White"/>
                        <TextBlock Text="参加した日数" FontSize="10" Foreground="#88FFFFFF"/>
                    </StackPanel>
                </Border>
                
                <Border Grid.Row="1" Grid.Column="1" Background="#25FFFFFF" CornerRadius="5" Margin="2" Padding="12">
                    <StackPanel>
                        <TextBlock Text="Last 7d Total" FontSize="10" Foreground="#AAFFFFFF"/>
                        <TextBlock x:Name="WeekTotalText" Text="0 min" FontSize="24" FontWeight="Bold" Foreground="White"/>
                        <TextBlock x:Name="WeekCompareText" Text="" FontSize="10" Foreground="#88FFFFFF"/>
                    </StackPanel>
                </Border>
            </Grid>
            
            <!-- This Week 棒グラフ -->
            <Border Grid.Row="2" Background="#25FFFFFF" CornerRadius="5" Padding="10" Margin="0,0,0,10">
                <StackPanel>
                    <TextBlock Text="This Week" FontSize="12" FontWeight="SemiBold" Foreground="White" Margin="0,0,0,8"/>
                    <Grid Height="100">
                        <Canvas x:Name="WeekBarChart"/>
                    </Grid>
                    <StackPanel x:Name="WeekDayLabels" Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,5,0,0"/>
                    <TextBlock x:Name="MaxMinText" Text="Max: 0 min / day" FontSize="10" Foreground="#88FFFFFF" Margin="0,5,0,0"/>
                </StackPanel>
            </Border>
            
            <!-- Recent Sessions -->
            <Border Grid.Row="3" Background="#25FFFFFF" CornerRadius="5" Padding="10" Margin="0,0,0,10">
                <StackPanel>
                    <TextBlock Text="Recent Sessions" FontSize="12" FontWeight="SemiBold" Foreground="White" Margin="0,0,0,8"/>
                    <StackPanel x:Name="RecentSessionsList"/>
                </StackPanel>
            </Border>
            
            <!-- Last 7 days detail -->
            <Border Grid.Row="4" Background="#25FFFFFF" CornerRadius="5" Padding="10">
                <StackPanel>
                    <TextBlock Text="Last 7 days detail" FontSize="12" FontWeight="SemiBold" Foreground="White" Margin="0,0,0,8"/>
                    <StackPanel x:Name="DailyDetailList"/>
                </StackPanel>
            </Border>
                </Grid>
            </ScrollViewer>
        </Grid>
    </Border>
</local:DraggableWidget>
